{"ast":null,"code":"import _asyncToGenerator from \"/Users/chineduetoh/Desktop/IONIC PROJECTS/Go_Rider/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport __NG_CLI_RESOURCE__0 from \"./phone-detail.page.html?ngResource\";\nimport __NG_CLI_RESOURCE__1 from \"./phone-detail.page.scss?ngResource\";\nimport { Component } from '@angular/core';\nimport { Auth } from '@angular/fire/auth';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ModalController, NavController } from '@ionic/angular';\nimport { OtpComponent } from 'src/app/otp/otp.component';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { AvatarService } from 'src/app/services/avatar.service';\nimport { OverlayService } from 'src/app/services/overlay.service';\nimport { environment } from 'src/environments/environment';\nlet PhoneDetailPage = class PhoneDetailPage {\n  constructor(modalCtrl, auth, authy, router, nav, authY, avatar, overlay, route) {\n    this.modalCtrl = modalCtrl;\n    this.auth = auth;\n    this.authy = authy;\n    this.router = router;\n    this.nav = nav;\n    this.authY = authY;\n    this.avatar = avatar;\n    this.overlay = overlay;\n    this.route = route;\n    this.CountryCode = '+1';\n    this.CountryJson = environment.CountryJson;\n    this.flag = \"https://cdn.kcak11.com/CountryFlags/countries/ng.svg\";\n  }\n\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.details = params[\"details\"];\n    });\n    this.form = new FormGroup({\n      phone: new FormControl(null, {\n        validators: [Validators.required, Validators.minLength(10), Validators.maxLength(10)]\n      })\n    });\n  }\n\n  countryCodeChange($event) {\n    console.log($event.detail.value.toString());\n    this.CountryCode = $event.detail.value.toString();\n  }\n\n  signIn() {\n    var _this = this;\n\n    return _asyncToGenerator(function* () {\n      if (!_this.approve2) try {\n        if (!_this.form.valid) {\n          _this.form.markAllAsTouched();\n\n          return;\n        }\n\n        console.log(_this.form.value);\n        _this.approve2 = true;\n        console.log(_this.details);\n        const response = yield _this.auth.signInWithPhoneNumber(_this.CountryCode + _this.form.value.phone);\n        _this.approve2 = false;\n        const options = {\n          component: OtpComponent,\n          componentProps: {\n            phone: _this.form.value.phone,\n            countryCode: _this.CountryCode\n          },\n          swipeToClose: true\n        };\n\n        const modal = _this.modalCtrl.create(options);\n\n        (yield modal).present();\n        const data = (yield modal).onWillDismiss();\n\n        _this.authy.onAuthStateChanged( /*#__PURE__*/function () {\n          var _ref = _asyncToGenerator(function* (user) {\n            if (user) {\n              const result = yield _this.avatar.createUser(_this.details.user.displayName, _this.details.user.email, _this.details.user.photoURL || '', _this.CountryCode + _this.form.value.phone, user.uid);\n              yield _this.avatar.createCard('Cash', 0, 'cash', 'None');\n\n              _this.router.navigateByUrl('home');\n            }\n\n            _this.overlay.hideLoader();\n          });\n\n          return function (_x) {\n            return _ref.apply(this, arguments);\n          };\n        }());\n      } catch (e) {\n        console.log(e);\n\n        _this.overlay.showAlert('Error', JSON.stringify(e));\n\n        _this.approve2 = false;\n      }\n    })();\n  }\n\n};\n\nPhoneDetailPage.ctorParameters = () => [{\n  type: ModalController\n}, {\n  type: AuthService\n}, {\n  type: Auth\n}, {\n  type: Router\n}, {\n  type: NavController\n}, {\n  type: Auth\n}, {\n  type: AvatarService\n}, {\n  type: OverlayService\n}, {\n  type: ActivatedRoute\n}];\n\nPhoneDetailPage = __decorate([Component({\n  selector: 'app-phone-detail',\n  template: __NG_CLI_RESOURCE__0,\n  styles: [__NG_CLI_RESOURCE__1]\n})], PhoneDetailPage);\nexport { PhoneDetailPage };","map":{"version":3,"mappings":"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","names":["Component","Auth","FormControl","FormGroup","Validators","ActivatedRoute","Router","ModalController","NavController","OtpComponent","AuthService","AvatarService","OverlayService","environment","PhoneDetailPage","constructor","modalCtrl","auth","authy","router","nav","authY","avatar","overlay","route","CountryJson","ngOnInit","queryParams","subscribe","params","details","form","phone","validators","required","minLength","maxLength","countryCodeChange","$event","console","log","detail","value","toString","CountryCode","signIn","approve2","valid","markAllAsTouched","response","signInWithPhoneNumber","options","component","componentProps","countryCode","swipeToClose","modal","create","present","data","onWillDismiss","onAuthStateChanged","user","result","createUser","displayName","email","photoURL","uid","createCard","navigateByUrl","hideLoader","e","showAlert","JSON","stringify","selector","template"],"sourceRoot":"","sources":["/Users/chineduetoh/Desktop/IONIC PROJECTS/Go_Rider/src/app/pages/phone-detail/phone-detail.page.ts"],"sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { Auth, linkWithCredential, PhoneAuthProvider } from '@angular/fire/auth';\nimport { FormControl, FormGroup, Validators } from '@angular/forms';\nimport { ActivatedRoute, Router } from '@angular/router';\nimport { ModalController, NavController, ModalOptions } from '@ionic/angular';\nimport { OtpComponent } from 'src/app/otp/otp.component';\nimport { AuthService } from 'src/app/services/auth.service';\nimport { AvatarService } from 'src/app/services/avatar.service';\nimport { OverlayService } from 'src/app/services/overlay.service';\nimport { environment } from 'src/environments/environment';\n\n\n@Component({\n  selector: 'app-phone-detail',\n  templateUrl: './phone-detail.page.html',\n  styleUrls: ['./phone-detail.page.scss'],\n})\nexport class PhoneDetailPage implements OnInit {\n  form: FormGroup;\n  CountryCode: any = '+1';\n  CountryJson = environment.CountryJson;\n  flag: any = \"https://cdn.kcak11.com/CountryFlags/countries/ng.svg\";\n  user: any;\n  approve: boolean;\n  approve2: boolean;\n  details: any;\n  constructor(\n    private modalCtrl: ModalController,\n    private auth: AuthService,\n    private authy: Auth,\n    private router: Router,\n    private nav: NavController,\n    private authY: Auth,\n    private avatar: AvatarService,\n    private overlay: OverlayService,\n    private route: ActivatedRoute,\n  ) { \n\n    \n  }\n\n  ngOnInit() {\n    this.route.queryParams.subscribe(params => {\n      this.details = params[\"details\"];\n  });\n    this.form = new FormGroup({\n      phone: new FormControl(null, {\n        validators: [Validators.required, Validators.minLength(10), Validators.maxLength(10)]\n      }),\n    });\n  }\n\n\n  countryCodeChange($event) {\n    console.log($event.detail.value.toString());\n    this.CountryCode = $event.detail.value.toString();\n  }\n\n  async signIn() {\n    if (!this.approve2)\n    try {\n      if (!this.form.valid) {\n        this.form.markAllAsTouched();\n        return;\n      }\n      console.log(this.form.value);\n      this.approve2 = true;\n\n      console.log(this.details);\n  \n      const response = await this.auth.signInWithPhoneNumber(this.CountryCode + this.form.value.phone);\n  \n      this.approve2 = false;\n      const options: ModalOptions = {\n        component: OtpComponent,\n        componentProps: {\n          phone: this.form.value.phone,\n          countryCode: this.CountryCode,\n        },\n        swipeToClose: true\n      };\n      const modal = this.modalCtrl.create(options);\n      (await modal).present();\n      const data: any = (await modal).onWillDismiss();\n      this.authy.onAuthStateChanged(async (user)=>{\n        if (user){\n      const result = await this.avatar.createUser(this.details.user.displayName, this.details.user.email, this.details.user.photoURL || '', this.CountryCode + this.form.value.phone, user.uid)\n      await this.avatar.createCard('Cash', 0, 'cash', 'None')\n      this.router.navigateByUrl('home');\n        }\n        this.overlay.hideLoader();\n      })\n      \n    } catch(e) {\n      console.log(e);\n      this.overlay.showAlert('Error', JSON.stringify(e));\n      this.approve2 = false;\n    }\n  }\n\n}\n"]},"metadata":{},"sourceType":"module"}